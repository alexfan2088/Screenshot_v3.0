<Window x:Class="Screenshot_v3_0.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="智能截屏 v3.0" Height="50" Width="850"
        Topmost="True"
        ResizeMode="CanResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="Manual">
  <Border CornerRadius="8" Background="#F5F5F5" BorderBrush="#D0D0D0" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#40000000" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
    </Border.Effect>
    <Grid Margin="8,6">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>

      <!-- 菜单栏 -->
      <Menu Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0">
        <MenuItem Header="设置">
          <MenuItem Header="参数配置" Click="MenuSettings_Click"/>
          <Separator/>
          <MenuItem Header="截图" x:Name="MenuScreenshot" IsCheckable="True" IsChecked="True" Click="MenuScreenshot_Click"/>
          <MenuItem Header="生成PPT" x:Name="MenuGeneratePPT" IsCheckable="True" IsChecked="True" Click="MenuGeneratePPT_Click"/>
          <MenuItem Header="生成PDF" x:Name="MenuGeneratePDF" IsCheckable="True" IsChecked="False" Click="MenuGeneratePDF_Click"/>
          <Separator/>
          <MenuItem Header="日志设置">
            <MenuItem Header="输出日志" x:Name="MenuLogEnabled" IsCheckable="True" IsChecked="True" Click="MenuLogEnabled_Click"/>
            <MenuItem Header="不输出日志" x:Name="MenuLogDisabled" IsCheckable="True" IsChecked="False" Click="MenuLogDisabled_Click"/>
            <Separator/>
            <MenuItem Header="日志文件覆盖" x:Name="MenuLogFileOverwrite" IsCheckable="True" IsChecked="True" Click="MenuLogFileOverwrite_Click"/>
            <MenuItem Header="日志文件叠加" x:Name="MenuLogFileAppend" IsCheckable="True" IsChecked="False" Click="MenuLogFileAppend_Click"/>
          </MenuItem>
        </MenuItem>
      </Menu>

      <!-- 视频录制按钮组和设置（中间部分） -->
      <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Left">
        <Button Content="开始" Width="35" Height="22" Margin="0,0,4,0" 
                Click="BtnStartVideo_Click" x:Name="BtnStartVideo" FontSize="9" Padding="2,1" ToolTip="开始录制视频"/>
        <Button Content="停止" Width="35" Height="22" Margin="0,0,4,0"
                Click="BtnStopVideo_Click" x:Name="BtnStopVideo" IsEnabled="False" FontSize="9" Padding="2,1" ToolTip="停止录制视频"/>
        <Button Content="选择" Width="32" Height="22" Margin="0,0,8,0"
                Click="BtnSelectRegion_Click" x:Name="BtnSelectRegion" FontSize="9" Padding="2,1" ToolTip="选择录制区域"/>
        
        <!-- 屏幕变化率设置 -->
        <TextBlock Text="变化率:" VerticalAlignment="Center" FontSize="9" Margin="0,0,2,0"/>
        <TextBox x:Name="TxtScreenChangeRate" Width="50" Height="20" FontSize="9" 
                 VerticalAlignment="Center" VerticalContentAlignment="Center" 
                 TextAlignment="Center" Margin="0,0,4,0" 
                 TextChanged="TxtScreenChangeRate_TextChanged" 
                 ToolTip="屏幕变化率 (1-1000%)"/>
        <TextBlock Text="%" VerticalAlignment="Center" FontSize="9" Margin="0,0,8,0"/>
        
        <!-- 截图间隔设置 -->
        <TextBlock Text="间隔:" VerticalAlignment="Center" FontSize="9" Margin="0,0,2,0"/>
        <TextBox x:Name="TxtScreenshotInterval" Width="40" Height="20" FontSize="9" 
                 VerticalAlignment="Center" VerticalContentAlignment="Center" 
                 TextAlignment="Center" Margin="0,0,2,0" 
                 TextChanged="TxtScreenshotInterval_TextChanged" 
                 ToolTip="截图间隔 (1-65535秒)"/>
        <TextBlock Text="秒" VerticalAlignment="Center" FontSize="9"/>
      </StackPanel>

      <!-- 信息显示和窗口控制按钮（右半部分） -->
      <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="8,0,0,0">
        <ScrollViewer x:Name="StatusBarScrollViewer" 
                      HorizontalScrollBarVisibility="Auto" 
                      VerticalScrollBarVisibility="Disabled"
                      Width="400" 
                      Height="20"
                      Margin="0,0,8,0"
                      VerticalAlignment="Center">
          <TextBlock x:Name="StatusBarInfo" FontSize="10" TextWrapping="NoWrap" VerticalAlignment="Center"/>
        </ScrollViewer>
        <!-- 窗口控制按钮 -->
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
          <Button Content="—" Width="22" Height="22" Margin="0,0,3,0" 
                  Click="BtnMinimize_Click" FontSize="12" Padding="0" 
                  Background="Transparent" BorderThickness="1" BorderBrush="#CCCCCC"
                  Cursor="Hand" ToolTip="最小化"/>
          <Button Content="×" Width="22" Height="22" 
                  Click="BtnClose_Click" FontSize="16" Padding="0" 
                  Background="Transparent" BorderThickness="1" BorderBrush="#CCCCCC"
                  Cursor="Hand" ToolTip="关闭">
            <Button.Style>
              <Style TargetType="Button">
                <Setter Property="Foreground" Value="#333333"/>
                <Style.Triggers>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E81123"/>
                    <Setter Property="Foreground" Value="White"/>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </Button.Style>
          </Button>
        </StackPanel>
      </StackPanel>
    </Grid>
  </Border>
</Window>
