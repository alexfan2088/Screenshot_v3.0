# 智能截屏 v3.0 操作手册

## 一、软件简介

智能截屏 v3.0 是一款 Windows 屏幕录制工具，能够：
- 检测屏幕指定区域的变化，当变化超过设定阈值时自动截图
- 将截图自动生成 PPT 和 PDF 文件
- 录制屏幕视频（含系统音频）
- 单独录制系统音频

## 二、系统要求

- **操作系统**: Windows 10/11
- **运行环境**: .NET 6.0 或更高版本
- **FFmpeg**: 需要将 `ffmpeg.exe` 放在程序目录中，或添加到系统 PATH

## 三、主界面说明

程序启动后显示一个置顶的工具栏，包含以下元素：

```
[设置] [开始] [停止] [选择] [恢复] 变化率:__% 间隔:__秒 时长:__分钟 [状态信息] [-][×]
```

### 按钮说明

| 按钮 | 功能 |
|------|------|
| **设置** | 打开设置菜单 |
| **开始** | 开始录制（需先选择区域） |
| **停止** | 停止录制并生成文件 |
| **选择** | 框选要监控的屏幕区域 |
| **恢复** | 恢复上次框选的区域 |

### 参数说明

| 参数 | 说明 | 范围 |
|------|------|------|
| **变化率** | 屏幕变化百分比阈值，超过此值触发截图 | 1-1000% |
| **间隔** | 最小截图间隔时间 | 1-65535 秒 |
| **时长** | 录制时长限制，0 表示无限制 | 0+ 分钟 |

## 四、基本操作流程

### 1. 选择监控区域

1. 点击 **[选择]** 按钮
2. 屏幕变暗，鼠标变为十字
3. 按住左键拖动，框选要监控的区域
4. 松开左键确认选择
5. 选择区域后，**[开始]** 按钮变为可用

### 2. 开始录制

1. 设置参数（变化率、间隔、时长）
2. 点击 **[开始]** 按钮
3. 程序开始监控屏幕变化并录制
4. 状态栏显示录制时长和截图数量

### 3. 停止录制

1. 点击 **[停止]** 按钮
2. 程序自动：
   - 停止录制
   - 合并音视频
   - 生成 PPT/PDF 文件
3. 弹出完成提示，显示生成的文件

## 五、设置菜单详解

### 音视频参数

点击 **设置 → 音视频参数** 打开设置窗口：

| 参数 | 选项 | 说明 |
|------|------|------|
| **分辨率比例** | 10-100% | 输出视频相对于原始区域的缩放比例 |
| **帧率** | 15/24/30/60 fps | 视频帧率，60fps 画质最优 |
| **视频码率** | Low/Medium/High/Auto | 视频质量，High 最清晰 |
| **音频采样率** | 22050/44100 Hz | 音频采样率 |
| **音频码率** | 64/128/192 kbps | 音频质量 |

### 音视频模式

| 模式 | 说明 |
|------|------|
| **不生成音、视频文件** | 仅截图，生成 PPT/PDF |
| **只生成音频文件** | 仅录制系统音频（WAV） |
| **只生成视频文件** | 录制视频+音频，输出 MP4 |
| **生成音频+视频文件** | 同时输出 WAV 和 MP4 |

### 输出选项

| 选项 | 说明 |
|------|------|
| **保留 JPG 文件** | 是否保留截图文件 |
| **生成 PPT** | 将截图生成 PowerPoint 文件 |
| **生成 PDF** | 将截图生成 PDF 文件 |

### 日志设置

| 选项 | 说明 |
|------|------|
| **输出日志 / 不输出日志** | 控制是否生成日志文件 |
| **日志文件覆盖 / 叠加** | 每次运行是覆盖还是追加日志 |

## 六、输出文件

录制完成后，所有文件保存在程序运行目录的子文件夹中：

```
录制目录/
├── screenshot_001.jpg      # 截图文件
├── screenshot_002.jpg
├── ...
├── audio_时间戳.wav         # 音频文件
├── video_时间戳.mp4         # 视频文件
├── presentation_时间戳.pptx # PPT 文件
└── presentation_时间戳.pdf  # PDF 文件
```

## 七、使用技巧

### 变化率设置建议

| 场景 | 建议变化率 |
|------|------------|
| 视频/动画播放 | 5-15% |
| PPT 翻页 | 10-20% |
| 网页浏览 | 15-30% |
| 文档编辑 | 20-50% |

### 性能优化

1. **降低分辨率比例**：如果不需要高清视频，可以设置为 50-75%
2. **降低帧率**：30fps 通常足够，可减少文件大小
3. **选择合适的码率**：Auto 模式会根据分辨率自动调整

### 静音录制

程序已优化静音处理：
- 即使开始录制时系统完全静音，也能正确录制
- 静音部分会被正确填充，确保音视频同步

## 八、常见问题

### Q: 开始按钮为什么是灰色的？
A: 需要先点击 **[选择]** 按钮框选监控区域。

### Q: 视频没有声音？
A: 确保系统有音频输出设备，程序会录制系统播放的声音（不是麦克风）。

### Q: 提示找不到 FFmpeg？
A: 下载 FFmpeg，将 `ffmpeg.exe` 放在程序同目录下，或添加到系统 PATH。

### Q: 生成的视频音画不同步？
A: 此问题已在 v3.0 版本中修复。如仍有问题，请确保使用最新版本。

### Q: 文件太大怎么办？
A: 可以：
1. 降低分辨率比例（设置 → 音视频参数）
2. 选择 Medium 或 Low 码率
3. 降低帧率到 30fps

## 九、快捷操作

- **拖动工具栏**：按住工具栏空白处可移动窗口位置
- **恢复区域**：点击 **[恢复]** 可快速恢复上次选择的区域

## 十、技术说明

- **视频录制**：使用 FFmpeg gdigrab 捕获屏幕
- **音频录制**：使用 NAudio WASAPI Loopback 捕获系统音频
- **PPT 生成**：使用 OpenXML SDK
- **PDF 生成**：使用 PdfSharpCore

---

*智能截屏 v3.0 - 让屏幕录制更智能*
